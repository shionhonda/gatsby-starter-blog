---
title: Downsizing StyleGAN2 for Training on a Single GPU 
date: "2020-03-03T22:12:03.284Z"
description: "This post introduces how to make top navigation bar with background image for Gatsby blog."
featuredImage: stylegan2/ogp.jpg
---
**StyleGAN2** [1] is famous for its success in generating high-resolution human face images that we can't tell apart from real images. For example, can you believe this image was generated by AI?

![](StyleGAN2.jpg)

\* You can get face images generated by StyleGAN2 [here](https://thispersondoesnotexist.com/).  

Have you ever thought of training StyleGAN2 yourself to generate other kinds of pictures, and probably gave up due to the limited machine resources? Actually, the authors trained it on **NVIDIA DGX-1** with 8 Tesla V100 GPUs for **9 days**. That's too expensive for individual researchers and practitioners! But don't worry. In this post, I demonstrate how to downsize StyleGAN2 to train from scratch **on a single GPU**, modifying [this PyTorch implementation](https://github.com/rosinality/stylegan2-pytorch).

Before reading this post, please make sure you really have to train it from scratch. If you want to generate 1024x1024 anime face images, you can fine-tune StyleGAN2 pre-trained on FFHQ. There are some pre-trained models for cars, cats, and so on, which are available in [the official repository](https://github.com/NVlabs/stylegan2).

## Dataset
Due to the limitation of the machine resources (I assume a single GPU with 8 GB RAM), I use the FFHQ dataset downsized to 256x256.  

First, download the original images using [the download script](https://github.com/NVlabs/ffhq-dataset). It will take several hours depending on your network capacity and result in about 80 GB.

```bash
python download_ffhq.py --images
```

Then, resize the images to 256x256 (e.g., with Pillow). 

## Implementation
Based on [the great PyTorch implementation](https://github.com/rosinality/stylegan2-pytorch) by [Kim Seonghyeon](https://github.com/rosinality), I downsize it to train on a single GPU.

## Results

![](result.jpeg)

<iframe width="560" height="315" src="https://www.youtube.com/embed/dR3-184rff4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

\* Skip if you don't use a background image  

First, install [gatsby-background-image](https://www.gatsbyjs.org/packages/gatsby-background-image/) and declare it in `gatsby-config.js` as described in the document.



```javascript:title=gatsby-config.js
module.exports = {
  plugins: [
    ...
    {
      resolve: 'gatsby-background-image',
      options: {
        // add your own characters to escape, replacing the default ':/'
        specialChars: '/:',
      },
    },
    ...
   ],
};
```  

